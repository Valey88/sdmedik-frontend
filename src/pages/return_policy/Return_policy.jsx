import React, { useEffect, useState } from "react";
import {
  Accordion,
  AccordionDetails,
  AccordionSummary,
  Box,
  Container,
  List,
  ListItem,
  Typography,
  Divider,
} from "@mui/material";
import ExpandMoreIcon from "@mui/icons-material/ExpandMore";
import { Helmet } from "react-helmet";
import api from "../../configs/axiosConfig";

export default function ReturnPolicy() {
  const [content, setContent] = useState({
    "page-title": "Политика возврата - СД-МЕД",
    "meta-description":
      "Узнайте о нашей политике возврата товаров и условиях возврата.",
    "meta-keywords": "возврат, политика возврата, товары, магазин",
    "canonical-link": "https://www.yourwebsite.com/return-policy",
    "main-heading": "<h1>Политика возврата</h1>",
    intro:
      "<p>Если по каким-либо причинам Вы решили отказаться от приобретенного товара, то можете сделать это в соответствии с Законом РФ «О защите прав потребителей» от 07.02.1992 № 2300-1. Федеральный закон от 21.11.2011 № 323-ФЗ «Об основах охраны здоровья граждан в Российской Федерации»; Постановление Правительства Российской Федерации от 31.12.2020 № 2463 «Об утверждении Правил продажи товаров по договору розничной купли-продажи, перечня товаров длительного пользования, на которые не распространяется требование потребителя о безвозмездном предоставлении ему товара, обладающего этими же основными потребительскими свойствами, на период ремонта или замены такого товара, и перечня непродовольственных товаров надлежащего качества, не подлежащих обмену, а также о внесении изменений в некоторые акты Правительства Российской Федерации». Перечень непродовольственных товаров надлежащего качества, не подлежащих возврату или обмену на аналогичный товар других размера, формы, габарита, фасона, расцветки или комплектации, утвержденный постановлением Правительства РФ от 19.01.1998г. № 55</p>",
    "sub-heading": "<h2>Изделия надлежащего качества</h2>",
    paragraph:
      "<p>Для возврата товара надлежащего качества, необходимо уточнить, не входит ли он в перечень товаров, не подлежащих возврату и обмену. К такой категории часто относят товары медицинского назначения, технически сложные устройства (большая часть электротехнических изделий), расходные материалы, товары личной гигиены, средства по уходу и тд. Важно! Политика нашей торговой сети предусматривает лояльный и заботливый подход к нашим клиентам, рассмотрение в индивидуальном порядке. А значит вы всегда можете обратиться к менеджеру, для уточнения, консультации, в разумные сроки, после приобретения.</p>",
    "accordion-1-title":
      "Если товар входит в перечень товаров, подлежащих возврату и обмену, или обоюдным решением установлено, что продавец готов принять товар:",
    "accordion-1-content-1":
      "<p>Возврат Товара надлежащего качества возможен в случае, если сохранены его товарный вид, потребительские свойства, а также документ, подтверждающий факт и условия покупки указанного Товара.</p>",
    "accordion-1-content-2":
      "<p>Возможен обмен товара на аналогичный, другого производителя, отличных характеристик, в том числе на более дорогой, с доплатой покупателя.</p>",
    "accordion-1-content-3":
      "<p>Возврат товаров надлежащего качества совершается в течение 14 дней с момента покупки.</p>",
    "accordion-1-content-4":
      "<p>Клиент не вправе отказаться от Товара, имеющего индивидуально-определенные свойства, если указанный Товар может быть использован исключительно приобретающим его Клиентом.</p>",
    "accordion-1-content-5":
      "<p>При отказе Клиента от Товара надлежащего качества Продавец должен возвратить ему денежную сумму, уплаченную потребителем по договору, за исключением расходов продавца на доставку от потребителя возвращенного товара, не позднее чем через 10 дней со дня предъявления потребителем соответствующего требования.</p>",
    "accordion-1-content-6":
      "<p>В случае возврата товара надлежащего качества, все расходы, связанные с транспортировкой товара до места приема товара продавцом (склад, торговая точка и т.д.), возлагаются на покупателя. Или рассматриваются в индивидуальном порядке, по решению продавца.</p>",
    "accordion-1-content-7":
      "<p>Гарантийному обслуживанию, обмену и возврату не подлежит: Продукция с повреждениями, вызванными нарушением правил транспортировки, хранения или эксплуатации; Продукция с следами ремонта; Продукция с поврежденной заводской маркировкой (модель, номер партии, серийный номер и т.д.) или гарантийной пломбой производителя.</p>",
    "accordion-2-title": "Возврат товара ненадлежащего качества",
    "accordion-2-content-1":
      "<p>Под товаром ненадлежащего качества подразумевается товар, не способный обеспечить свои функциональные качества из-за существенного недостатка (с наличием дефектов/брака).</p>",
    "accordion-2-content-2":
      "<p>Покупатель, которому продан товар ненадлежащего качества, если это не было оговорено продавцом, вправе по своему выбору заявить любое из нижеперечисленных требований: <ul><li>1: замены на товар аналогичной марки (модели, артикула) или на такой же товар другой марки (модели, артикула) с соответствующим перерасчетом покупной цены;</li><li>2: соразмерного уменьшения покупной цены;</li><li>3: безвозмездного устранения недостатков товара или возмещения расходов на их исправление покупателем или третьим лицом;</li><li>4: вправе отказаться от исполнения договора и потребовать возврата уплаченной за товар суммы.</li></ul></p>",
    "accordion-2-content-3":
      "<p>При возврате технически сложного товара ненадлежащего качества (перечень таких товаров утвержден Постановлением Правительства РФ от 10.11.2011 № 924 «Об утверждении перечня технически сложных товаров») Покупатель имеет право потребовать: <ul><li>1: замены на товар аналогичной марки (модели, артикула) или на такой же товар другой марки (модели, артикула) с соответствующим перерасчетом покупной цены;</li><li>2: отказаться от исполнения договора и потребовать возврата уплаченной за товар суммы.</li></ul></p>",
    "accordion-2-content-4":
      "<p>Все вышеперечисленные требования по возврату товара ненадлежащего качества могут быть предъявлены в следующие сроки: <ul><li>1: На товар установлен гарантийный срок — в течение всего гарантийного срока;</li><li>2: На товар не установлен гарантийный срок — в течение разумного срока, но не более 1 месяца.</li></ul></p>",
    "accordion-2-content-5":
      "<p>Интернет-магазин вправе отказать в обмене или возврате товара, если сочтет, что обнаруженный существенный недостаток является следствием неправильной эксплуатации товара, его износа.</p>",
    "accordion-2-content-6":
      "<p>В случае возникновения разногласий по качеству или причинам возникновения недостатков, Интернет-магазин вправе провести независимую экспертизу за свой счет. Покупатель может участвовать в экспертизе и оспорить ее решение в суде. Если в результате экспертизы установлено, что недостатки товара возникли по вине Покупателя, то Покупатель обязан возместить Интернет-магазину стоимость экспертизы, а также связанные с ее проведением расходы на транспортировку и хранение товара.</p>",
    "accordion-2-content-7":
      "<p>Требования к продавцу необходимо предъявлять в письменной форме. Претензия составляется в двух экземплярах в свободной форме с указанием: Ф.И.О., адреса заявителя; наименования лекарственного препарата, даты и места его приобретения; обнаруженных недостатков; требования к продавцу. Потребитель также должен возвратить продавцу товар ненадлежащего качества для проведения проверки качества.</p>",
    "accordion-2-content-8":
      "<p>На одном из экземпляров продавец (или представитель продавца) ставит свою подпись с указанием Ф.И.О. и должности, дату принятия претензии и печать продавца (при наличии). Этот экземпляр претензии остается у потребителя в подтверждение его обращения к продавцу. При отказе продавца принять претензию или проставить на втором ее экземпляре отметку о приеме рекомендуется направить претензию заказным письмом с уведомлением о вручении и описью вложения на юридический адрес продавца.</p>",
    "accordion-2-content-9":
      "<p>При возврате покупки курьером или почтой сначала пришлите продавцу заявление на возврат товара. В заявлении укажите, каким способом вы хотите получить обратно деньги, и спросите, на какой адрес отправлять покупку. Заявление отправьте заказным письмом на юридический адрес продавца, а для ускорения продублируйте письмо по электронной почте.</p>",
    "accordion-2-content-10":
      "<p>После того как продавец подтвердит адрес и возможность возврата, можно отправлять сам товар.</p>",
    "accordion-2-content-11":
      "<p>Либо, обращение к продавцу, на месте выдачи товара, может быть рассмотрено и удовлетворено в день обращения, по решению представителя продавца.</p>",
  });

  useEffect(() => {
    const fetchContent = async () => {
      try {
        const response = await api.get("/page/returnpolicy");
        console.log("ReturnPolicy API Response:", response.data); // Отладка
        const newContent = {};
        // Извлекаем элементы из response.data.data.elements или response.data.elements
        const elements = Array.isArray(response.data?.data?.elements)
          ? response.data.data.elements
          : Array.isArray(response.data?.elements)
          ? response.data.elements
          : [];
        elements.forEach((item) => {
          newContent[item.element_id] = item.value;
        });
        console.log("Processed content:", newContent); // Отладка
        setContent((prev) => ({ ...prev, ...newContent }));
      } catch (error) {
        console.error("Error fetching page content:", error);
      }
    };
    fetchContent();
  }, []);

  return (
    <Box sx={{ backgroundColor: "#F9F9F9", padding: "20px" }}>
      <Helmet>
        <title>{content["page-title"] || "Политика возврата - СД-МЕД"}</title>
        <meta name="description" content={content["meta-description"] || ""} />
        <meta name="keywords" content={content["meta-keywords"] || ""} />
        <link
          rel="canonical"
          href={
            content["canonical-link"] ||
            "https://www.yourwebsite.com/return-policy"
          }
        />
      </Helmet>
      <Container maxWidth="md">
        <header>
          <Box sx={{ display: "flex", justifyContent: "center", mb: 4 }}>
            <Typography
              component="h1"
              variant="h2"
              sx={{ fontWeight: "bold", color: "#333", fontSize: "24px", textAlign: "center" }}
              dangerouslySetInnerHTML={{
                __html: content["main-heading"] || "<h1>Политика возврата</h1>",
              }}
            />
          </Box>
          <Divider
            sx={{
              my: 2,
              borderColor: "#00B3A4",
              width: "50%",
              margin: "0 auto",
            }}
          />
        </header>
        <Box sx={{ mb: 4 }}>
          <Typography
            variant="body1"
            sx={{ color: "#555", lineHeight: 1.6, fontSize: "20px" }}
            dangerouslySetInnerHTML={{
              __html: content["intro"] || "<p>Нет данных</p>",
            }}
          />
          <Box sx={{ textAlign: "center", mt: 2 }}>
            <img
              style={{ width: "100%", borderRadius: "8px" }}
              src="/return-policy.png"
              alt="Политика возврата"
            />
          </Box>
        </Box>
        <Box
          sx={{
            display: "flex",
            flexDirection: "column",
            gridGap: "40px",
            mb: 5,
          }}
        >
          <Typography
            sx={{
              fontSize: "28px",
              fontWeight: "medium",
              display: "flex",
              justifyContent: "center",
              alignItems: "center",
              color: "#00B3A4",
            }}
            dangerouslySetInnerHTML={{
              __html:
                content["sub-heading"] ||
                "<h2>Изделия надлежащего качества</h2>",
            }}
          />
          <Box>
            <Typography
              variant="h5"
              component="p"
              sx={{ color: "#555", lineHeight: 1.6, fontSize: "25px" }}
              dangerouslySetInnerHTML={{
                __html: content["paragraph"] || "<p>Нет данных</p>",
              }}
            />
          </Box>
          <Box
            sx={{ display: "flex", flexDirection: "column", gridGap: "40px" }}
          >
            <Accordion sx={{ background: "#90E0D4", color: "#fff" }}>
              <AccordionSummary
                expandIcon={
                  <ExpandMoreIcon fontSize="medium" sx={{ color: "#fff" }} />
                }
                sx={{ fontSize: "22px" }}
              >
                {content["accordion-1-title"] ||
                  "Если товар входит в перечень товаров, подлежащих возврату..."}
              </AccordionSummary>
              <AccordionDetails sx={{ maxHeight: 400, overflow: "auto" }}>
                <List>
                  {[
                    "accordion-1-content-1",
                    "accordion-1-content-2",
                    "accordion-1-content-3",
                    "accordion-1-content-4",
                    "accordion-1-content-5",
                    "accordion-1-content-6",
                    "accordion-1-content-7",
                  ].map((contentId) => (
                    <ListItem key={contentId}>
                      <Typography
                        variant="h6"
                        dangerouslySetInnerHTML={{
                          __html: content[contentId] || "<p>Нет данных</p>",
                        }}
                      />
                    </ListItem>
                  ))}
                </List>
              </AccordionDetails>
            </Accordion>
            <Accordion sx={{ background: "#90E0D4", color: "#fff" }}>
              <AccordionSummary
                expandIcon={
                  <ExpandMoreIcon fontSize="medium" sx={{ color: "#fff" }} />
                }
                sx={{ fontSize: "22px" }}
              >
                {content["accordion-2-title"] ||
                  "Возврат товара ненадлежащего качества"}
              </AccordionSummary>
              <AccordionDetails sx={{ maxHeight: 400, overflow: "auto" }}>
                <List>
                  {[
                    "accordion-2-content-1",
                    "accordion-2-content-2",
                    "accordion-2-content-3",
                    "accordion-2-content-4",
                    "accordion-2-content-5",
                    "accordion-2-content-6",
                    "accordion-2-content-7",
                    "accordion-2-content-8",
                    "accordion-2-content-9",
                    "accordion-2-content-10",
                    "accordion-2-content-11",
                  ].map((contentId) => (
                    <ListItem key={contentId}>
                      <Typography
                        variant="h6"
                        dangerouslySetInnerHTML={{
                          __html: content[contentId] || "<p>Нет данных</p>",
                        }}
                      />
                    </ListItem>
                  ))}
                </List>
              </AccordionDetails>
            </Accordion>
          </Box>
        </Box>
      </Container>
    </Box>
  );
}
